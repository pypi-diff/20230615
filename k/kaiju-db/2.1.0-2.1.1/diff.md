# Comparing `tmp/kaiju_db-2.1.0-py3-none-any.whl.zip` & `tmp/kaiju_db-2.1.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,19 @@
-Zip file size: 21721 bytes, number of entries: 16
--rw-r--r--  2.0 unx      204 b- defN 23-Jun-08 21:08 kaiju_db/__init__.py
--rw-r--r--  2.0 unx     3665 b- defN 23-Jun-08 21:08 kaiju_db/functions.py
--rw-r--r--  2.0 unx      204 b- defN 23-Jun-08 21:08 kaiju_db/ltree.py
--rw-r--r--  2.0 unx     4522 b- defN 23-Jun-08 21:08 kaiju_db/migrations.py
--rw-r--r--  2.0 unx      148 b- defN 23-Jun-08 21:08 kaiju_db/services.py
--rw-r--r--  2.0 unx    39624 b- defN 23-Jun-08 21:08 kaiju_db/sql_service.py
--rw-r--r--  2.0 unx     9697 b- defN 23-Jun-08 21:08 kaiju_db/transport.py
--rw-r--r--  2.0 unx      206 b- defN 23-Jun-08 21:08 kaiju_db/types.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jun-08 21:08 kaiju_db/tests/__init__.py
--rw-r--r--  2.0 unx     3568 b- defN 23-Jun-08 21:08 kaiju_db/tests/fixtures.py
--rw-r--r--  2.0 unx    13643 b- defN 23-Jun-08 21:08 kaiju_db/tests/test_services.py
--rw-rw-rw-  2.0 unx      610 b- defN 23-Jun-08 21:08 kaiju_db-2.1.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     3089 b- defN 23-Jun-08 21:08 kaiju_db-2.1.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-08 21:08 kaiju_db-2.1.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        9 b- defN 23-Jun-08 21:08 kaiju_db-2.1.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     1255 b- defN 23-Jun-08 21:08 kaiju_db-2.1.0.dist-info/RECORD
-16 files, 80536 bytes uncompressed, 19667 bytes compressed:  75.6%
+Zip file size: 22984 bytes, number of entries: 17
+-rw-r--r--  2.0 unx      282 b- defN 23-Jun-15 16:09 kaiju_db/__init__.py
+-rw-r--r--  2.0 unx     3127 b- defN 23-Jun-15 16:09 kaiju_db/fixtures.py
+-rw-r--r--  2.0 unx     3665 b- defN 23-Jun-15 16:09 kaiju_db/functions.py
+-rw-r--r--  2.0 unx      204 b- defN 23-Jun-15 16:09 kaiju_db/ltree.py
+-rw-r--r--  2.0 unx     4522 b- defN 23-Jun-15 16:09 kaiju_db/migrations.py
+-rw-r--r--  2.0 unx      386 b- defN 23-Jun-15 16:09 kaiju_db/services.py
+-rw-r--r--  2.0 unx    39661 b- defN 23-Jun-15 16:09 kaiju_db/sql_service.py
+-rw-r--r--  2.0 unx     9761 b- defN 23-Jun-15 16:09 kaiju_db/transport.py
+-rw-r--r--  2.0 unx      206 b- defN 23-Jun-15 16:09 kaiju_db/types.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-15 16:09 kaiju_db/tests/__init__.py
+-rw-r--r--  2.0 unx     3568 b- defN 23-Jun-15 16:09 kaiju_db/tests/fixtures.py
+-rw-r--r--  2.0 unx    13635 b- defN 23-Jun-15 16:09 kaiju_db/tests/test_services.py
+-rw-rw-rw-  2.0 unx      610 b- defN 23-Jun-15 16:09 kaiju_db-2.1.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3090 b- defN 23-Jun-15 16:09 kaiju_db-2.1.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-15 16:09 kaiju_db-2.1.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        9 b- defN 23-Jun-15 16:09 kaiju_db-2.1.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1332 b- defN 23-Jun-15 16:09 kaiju_db-2.1.1.dist-info/RECORD
+17 files, 84150 bytes uncompressed, 20814 bytes compressed:  75.3%
```

## zipnote {}

```diff
@@ -1,10 +1,13 @@
 Filename: kaiju_db/__init__.py
 Comment: 
 
+Filename: kaiju_db/fixtures.py
+Comment: 
+
 Filename: kaiju_db/functions.py
 Comment: 
 
 Filename: kaiju_db/ltree.py
 Comment: 
 
 Filename: kaiju_db/migrations.py
@@ -27,23 +30,23 @@
 
 Filename: kaiju_db/tests/fixtures.py
 Comment: 
 
 Filename: kaiju_db/tests/test_services.py
 Comment: 
 
-Filename: kaiju_db-2.1.0.dist-info/LICENSE
+Filename: kaiju_db-2.1.1.dist-info/LICENSE
 Comment: 
 
-Filename: kaiju_db-2.1.0.dist-info/METADATA
+Filename: kaiju_db-2.1.1.dist-info/METADATA
 Comment: 
 
-Filename: kaiju_db-2.1.0.dist-info/WHEEL
+Filename: kaiju_db-2.1.1.dist-info/WHEEL
 Comment: 
 
-Filename: kaiju_db-2.1.0.dist-info/top_level.txt
+Filename: kaiju_db-2.1.1.dist-info/top_level.txt
 Comment: 
 
-Filename: kaiju_db-2.1.0.dist-info/RECORD
+Filename: kaiju_db-2.1.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## kaiju_db/__init__.py

```diff
@@ -1,9 +1,12 @@
 from .types import *
 from .ltree import *
 from .functions import *
-from .services import *
+from .migrations import *
+from .transport import *
+from .sql_service import *
+from .fixtures import *
 
-__version__ = '2.1.0'
+__version__ = '2.1.1'
 __python_version__ = '3.8'
 __author__ = 'antonnidhoggr@me.com'
 __service_package__ = True
```

## kaiju_db/services.py

```diff
@@ -1,3 +1,9 @@
-from kaiju_db.transport import DatabaseService
-from kaiju_db.sql_service import SQLService
-from kaiju_db.migrations import DatabaseMigrationService
+from kaiju_tools.app import service_class_registry
+from .transport import DatabaseService
+from .migrations import DatabaseMigrationService
+from .sql_service import SQLService
+from .fixtures import FixtureService
+
+service_class_registry.register_class(DatabaseService)
+service_class_registry.register_class(DatabaseMigrationService)
+service_class_registry.register_class(FixtureService)
```

## kaiju_db/sql_service.py

```diff
@@ -1,7 +1,9 @@
+"""Interface for managing data in db."""
+
 import abc
 from typing import List, AsyncGenerator, Union, Optional, TypedDict
 
 import sqlalchemy as sa
 from sqlalchemy.dialects.postgresql import insert
 from sqlalchemy.exc import IntegrityError
 from sqlalchemy.sql.expression import nullslast
@@ -96,23 +98,23 @@
     # virtual columns can be selected but never updated / inserted
 
     def __init__(self, app, database_service: Union[DatabaseService, str] = None, logger=None):
         """Initialize."""
 
         def _prepare_whitelist(whitelist, blacklist):
             if blacklist:
-                whitelist = set(col.name for col in self.table.columns) if whitelist is None else set(whitelist)
+                whitelist = {col.name for col in self.table.columns} if whitelist is None else set(whitelist)
                 return frozenset(whitelist.difference(set(blacklist)))
             elif whitelist:
                 return frozenset(whitelist)
 
         Service.__init__(self, app=app, logger=logger)
         self._db = self.discover_service(database_service, cls=DatabaseService)
         self.table = self._db.add_table(self.table)  # registers table in the db service meta
-        self._primary_keys = frozenset((col.name for col in self.table.primary_key))
+        self._primary_keys = frozenset(col.name for col in self.table.primary_key)
         self._composite_primary_key = len(self._primary_keys) > 1
         if self._composite_primary_key:
             self._primary_key_condition = self._create_primary_key_condition_for_composite_key
             self._list_primary_key_condition = self._create_list_primary_key_condition_for_composite_key
             self._primary_key = self._primary_key_list = list(self.table.primary_key)
         elif len(self._primary_keys) == 1:
             self._primary_key_condition = self._create_primary_key_condition_for_single_key
```

## kaiju_db/transport.py

```diff
@@ -1,7 +1,9 @@
+"""DB connection, tables and roles initialization."""
+
 from typing import List
 
 from sqlalchemy import MetaData, text, Table  # noqa pycharm
 from sqlalchemy.ext.asyncio import create_async_engine  # noqa pycharm
 
 from kaiju_tools.services import ContextableService
 from kaiju_tools.serialization import dumps, loads
@@ -105,39 +107,39 @@
                 ...
                 await conn.commit()
 
         """
         return self.engine.connect(*args, **kws)
 
     async def execute(self, __obj, *args, _commit=True, _conn=None, **kws):
-        """Execute an sql command."""
+        """Execute an SQL command."""
         if type(__obj) is str:
             __obj = text(__obj)
         if _conn:
             result = await _conn.execute(__obj, *args, **kws)
         else:
             async with self._engine.connect() as conn:
                 result = await conn.execute(__obj, *args, **kws)
                 if _commit:
                     await conn.commit()
         return result
 
     async def fetchrow(self, __obj, *args, _commit=True, _conn=None, **kws):
-        """Execute SQL command and fetch the first result."""
+        """Execute an SQL command and fetch the first result."""
         result = await self.execute(__obj, *args, _commit=_commit, _conn=_conn, **kws)
         result = result.first()
         return result._asdict() if result else None  # noqa
 
     async def fetch(self, __obj, *args, _commit=True, _conn=None, **kws):
-        """Execute SQL command and fetch all results."""
+        """Execute an SQL command and fetch all results."""
         result = await self.execute(__obj, *args, _commit=_commit, _conn=_conn, **kws)
         return [r._asdict() for r in result.all()]  # noqa
 
     async def fetchval(self, __obj, *args, _commit=True, _conn=None, **kws):
-        """Execute SQL command and fetch a first column in the first result."""
+        """Execute an SQL command and fetch a first column in the first result."""
         result = await self.execute(__obj, *args, _commit=_commit, _conn=_conn, **kws)
         return result.scalar()
 
     async def init(self):
         if self._init_db:
             await self._init_database()
         self._root_user = None
```

## kaiju_db/tests/test_services.py

```diff
@@ -6,15 +6,15 @@
 
 from kaiju_tools.exceptions import NotFound, ValidationError, Conflict
 from kaiju_tools.serialization import dumps
 
 from .fixtures import *
 from ..functions import functions_registry
 from ..migrations import MigrationState
-from ..services import SQLService, DatabaseMigrationService
+from .. import SQLService, DatabaseMigrationService
 
 
 @pytest.mark.asyncio
 @pytest.mark.docker
 async def test_database_service(database, database_service, test_table, test_function, logger):
     logger.debug('Testing init')
     functions_registry.register_class(test_function)
```

## Comparing `kaiju_db-2.1.0.dist-info/LICENSE` & `kaiju_db-2.1.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `kaiju_db-2.1.0.dist-info/METADATA` & `kaiju_db-2.1.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: kaiju-db
-Version: 2.1.0
+Version: 2.1.1
 Summary: Postgresql db services and tools
 Home-page: https://gitlab.com/kaiju-python/kaiju-db
 Author: antonnidhoggr@me.com
 Author-email: antonnidhoggr@me.com
 License: Apache Software License 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: License :: OSI Approved :: Apache Software License
@@ -16,15 +16,15 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: Implementation :: CPython
 Requires-Python: >=3.8
 Description-Content-Type: text/x-rst
 License-File: LICENSE
 Requires-Dist: asyncpg (>=0.27)
 Requires-Dist: greenlet (>=2.0.2)
-Requires-Dist: sqlalchemy[asyncio] (>=2.0.9)
+Requires-Dist: sqlalchemy[asyncio] (>=2.0.16)
 Requires-Dist: sqlalchemy-utils (>=0.41)
 Requires-Dist: kaiju-tools (<3,>=2)
 Provides-Extra: dev
 Requires-Dist: bump2version (>=1.0) ; extra == 'dev'
 Requires-Dist: pyroma (>=4.1) ; extra == 'dev'
 Requires-Dist: bandit (>=1.7) ; extra == 'dev'
 Requires-Dist: black (>=22.12) ; extra == 'dev'
```

## Comparing `kaiju_db-2.1.0.dist-info/RECORD` & `kaiju_db-2.1.1.dist-info/RECORD`

 * *Files 18% similar despite different names*

```diff
@@ -1,16 +1,17 @@
-kaiju_db/__init__.py,sha256=EnxbNeaWnLLWMnLqVi3DXfIQp_0gVKVrp32QdhqRlLY,204
+kaiju_db/__init__.py,sha256=UaoyWUgwUSEytOKYYYlZqYXHnZZFpukfR_CcGJOJgSk,282
+kaiju_db/fixtures.py,sha256=AuzsoL8HAWMCPITs9TvqZVv6iQaJ9no5Z4bp_iuQcwo,3127
 kaiju_db/functions.py,sha256=0E7H85QZkRvPBMa6H5n9eC5tJlCvKXPvKT6e5O-nuGQ,3665
 kaiju_db/ltree.py,sha256=Y2g_GZ9T7dQRYknAkuUmDjHTrrdyPEu1d9QQDJ-Gsus,204
 kaiju_db/migrations.py,sha256=mv4ytDcoUasB1-DlcrxBBkF1UJ3PKuoEN7l921EyYLc,4522
-kaiju_db/services.py,sha256=kTHtHXMw1rLFxGk1hJnaZ4xqRmnD921C4PtKVUvPIto,148
-kaiju_db/sql_service.py,sha256=wSMMBz-YLG_Iv4xj24g2Jfe9_UGFW74vAwJ-6wAD60o,39624
-kaiju_db/transport.py,sha256=tG_8EP8MsGs_IXQVTY4t9G_FVxpMK9XIouzpetb2Kb4,9697
+kaiju_db/services.py,sha256=VczBFT8V9q-N7EleZ2DvgY_SMOHaTL_NRiJ7C2f_9M8,386
+kaiju_db/sql_service.py,sha256=I1fx1PDB5OHBjmsdCalIys22ERIIUh2_vnFRWKF9dvs,39661
+kaiju_db/transport.py,sha256=fP1qLLz6wywhsA6FHsjen-vh-LW3_X81TkZJn2paZgI,9761
 kaiju_db/types.py,sha256=Au_j6lWIRLDrHdmbRiHDquxEnjOOU1bCDmJftkHxJmY,206
 kaiju_db/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_db/tests/fixtures.py,sha256=a4hayXLJyEJOjxQgzHpaqUusp5urpR-I6x_x1SaANcA,3568
-kaiju_db/tests/test_services.py,sha256=v-v-OMwCM2NxSQqVII8imtArrLcRaQ3ILXYtCoonUp8,13643
-kaiju_db-2.1.0.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
-kaiju_db-2.1.0.dist-info/METADATA,sha256=QuLKu9D9fFnF0NLNgKYV7PXmEG-uo9lGT_Psnm7mZQ0,3089
-kaiju_db-2.1.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-kaiju_db-2.1.0.dist-info/top_level.txt,sha256=-jcfPgSkIz8rxFCPp_XIg5g9tVsDmBd1wdxayb_mkNU,9
-kaiju_db-2.1.0.dist-info/RECORD,,
+kaiju_db/tests/test_services.py,sha256=sEzOtI4e3I6sakqBCzq1fMNZR5q-D0G7rQ66tpyiRGo,13635
+kaiju_db-2.1.1.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
+kaiju_db-2.1.1.dist-info/METADATA,sha256=TodZOu9MNc2eBXy-ZsOmCH3jmMkjbgTRwZeea6Uzuys,3090
+kaiju_db-2.1.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+kaiju_db-2.1.1.dist-info/top_level.txt,sha256=-jcfPgSkIz8rxFCPp_XIg5g9tVsDmBd1wdxayb_mkNU,9
+kaiju_db-2.1.1.dist-info/RECORD,,
```

